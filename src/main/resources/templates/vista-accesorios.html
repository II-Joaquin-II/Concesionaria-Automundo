<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Accesorios para Autos</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <style>
            .accesorio-card img {
                width: 100%;
                height: auto;
            }
            .accesorio-card {
                margin: 15px 0;
                border: 1px solid #ddd;
                border-radius: 8px;
                overflow: hidden;
            }
            .accesorio-card-body {
                padding: 15px;
            }
            .btn-primary {
                background-color: #007bff;
                border: none;
            }
            /* Imagen principal grande */
            .main-image {
                width: 100%;
                max-height: 300px;
                object-fit: contain;
                margin-bottom: 15px;
                border-radius: 8px;
                border: 1px solid #ccc;
            }
            /* Contenedor de miniaturas */
            .thumbnails-container {
                display: flex;
                justify-content: center; /* Centrar las miniaturas */
                overflow-x: auto; /* Permite hacer scroll horizontal si las miniaturas son muchas */
                gap: 10px; /* Espacio entre miniaturas */
                padding: 5px 0; /* Padding vertical para las miniaturas */
            }

            /* Miniaturas pequeñas */
            .thumbnail {
                width: 60px;   /* Tamaño pequeño para las miniaturas */
                height: 60px;
                cursor: pointer;
                border-radius: 8px;
                border: 2px solid transparent;
                object-fit: cover;   /* Asegura que las imágenes se ajusten sin distorsión */
                transition: border-color 0.3s, opacity 0.3s;
                max-width: 60px;   /* Evita que se estiren */
                max-height: 60px;  /* Mantiene las miniaturas dentro del tamaño definido */
            }

            .thumbnail:hover {
                opacity: 0.8;
            }

            .thumbnail.active {
                border-color: #007bff;
            }

            /* Estilo para el nombre y el precio */
            .card-title {
                font-weight: bold;
                font-size: 1.2rem;
                color: #333;
            }

            .card-text.price {
                font-size: 1.1rem;
                color: #007bff;
                font-weight: bold;
            }

            /* Centrar el botón "Agregar" sin cambiar su tamaño */
            .add-to-cart {
                text-align: center;
                margin-top: 15px;
            }
        </style>
    </head>
    <body>
        <header class="p-3 text-bg-dark header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-12 col-md-4 mb-3 mb-md-0 text-md-start">
                        <ul class="nav justify-content-center fs-5">
                            <li class="nav-item">
                                <a href="" class="nav-link fw-bold text-white px-3">NOSOTROS</a>
                            </li>
                            <li class="nav-item">
                                <a href="" class="nav-link fw-bold text-white px-3">AUTOS</a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-12 col-md-4 text-center mb-3 mb-md-0">
                        <a>
                            <img src="img/LOGOV.4.png" class="img-fluid" alt="Logo">
                        </a>
                    </div>
                    <div class="col-12 col-md-4 text-center text-md-end">
                        <div>

                            <div th:if="${#authorization.expression('isAuthenticated()')}">
                                <span th:text="${nombreUsuario}"></span>
                                <a th:href="@{/logout}" class="btn btn-warning btn-sm me-2">Cerrar sesión</a>
                            </div>

                            <div th:if="${#authorization.expression('!isAuthenticated()')}">
                                <a th:href="@{/login}" class="btn btn-outline-light btn-sm me-2">Iniciar sesión</a>
                                <a th:href="@{/registro}" class="btn btn-warning btn-sm me-2">Registrarse</a>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </header>
        <div class="container mt-5">
            <h2 class="text-center mb-4">Accesorios Disponibles</h2>

            <div class="row">
                <div class="col-md-4" th:each="acc, iterStat : ${accesorios}">
                    <div class="card accesorio-card">
                        <div class="accesorio-card-body">
                            <!-- Nombre del accesorio con estilo resaltado -->
                            <h5 class="card-title" th:text="${acc.nombre}">Nombre del Accesorio</h5>

                            <!-- Descripción -->
                            <p class="card-text" th:text="${acc.descripcion}">Descripción del accesorio</p>

                            <!-- Precio con estilo resaltado -->
                            <p class="card-text price">Precio: S/. <span th:text="${'%.2f'.formatted(acc.precio)}">0.00</span></p>

                            <!-- Colores disponibles -->
                            <p class="card-text">Colores: <span th:text="${acc.colores}">Colores disponibles</span></p>

                            <!-- Imagen principal grande -->
                            <img th:id="'main-image-' + ${iterStat.index}"
                                 th:src="@{'/img/' + ${#strings.arraySplit(acc.imagen, ',')[0]}}"
                                 alt="Imagen principal"
                                 class="main-image" />

                            <!-- Contenedor para las miniaturas centradas -->
                            <div class="thumbnails-container">
                                <img th:each="img, imgStat : ${#strings.arraySplit(acc.imagen, ',')}"
                                     th:src="@{'/img/' + ${img}}"
                                     class="thumbnail"
                                     th:classappend="${imgStat.index == 0} ? ' active' : ''"
                                     alt="Miniatura"
                                     th:onclick="'changeImage(' + ${iterStat.index} + ', this)'"
                                     />
                            </div>

                            <!-- Botón de agregar centrado -->
                            <div class="add-to-cart">
                                <a href="#" class="btn btn-primary">Agregar</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            function changeImage(index, imgElement) {
                const mainImage = document.getElementById('main-image-' + index);
                if (!mainImage)
                    return;
                mainImage.src = imgElement.src;

                // Actualizar miniaturas activas
                const thumbnailsContainer = imgElement.parentElement;
                const thumbnails = thumbnailsContainer.querySelectorAll('.thumbnail');
                thumbnails.forEach(thumb => thumb.classList.remove('active'));
                imgElement.classList.add('active');
            }
        </script>

    </body>
</html>
